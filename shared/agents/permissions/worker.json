{
  "_description": "Worker agent permissions - full access except core/",

  "file_access": {
    "read": {
      "allowed_paths": [
        "**"
      ],
      "blocked_paths": [
        "/home/bryan/.ssh/**",
        "/home/bryan/.gnupg/**",
        "**/credentials*",
        "**/*password*",
        "**/*secret*"
      ],
      "max_file_size_mb": 50
    },
    "write": {
      "allowed_paths": [
        "/media/bryan/shared/**",
        "/home/bryan/llm_orchestration/**",
        "/tmp/**"
      ],
      "blocked_paths": [
        "**/core/**"
      ],
      "max_file_size_mb": 50
    }
  },

  "bash": {
    "allowed_commands": [
      ".*"
    ],
    "blocked_patterns": [
      "rm\\s+-rf\\s+/$",
      "sudo\\s",
      "chmod.*core",
      "chown.*core",
      ">.*core/",
      "mkfs",
      "dd\\s+if=",
      ":(){ :|:& };:",
      "SYSTEM\\.md",
      "RULES\\.md",
      "ESCALATION_POLICY\\.md",
      "passwd",
      "visudo",
      "\\.ssh"
    ],
    "timeout_seconds": 1800,
    "allow_background": true
  },

  "network": {
    "allowed_hosts": [
      "localhost",
      "127.0.0.1",
      "10.0.0.*"
    ],
    "allowed_ports": [11434, 11435, 11436, 11437],
    "block_external": true
  },

  "capabilities": {
    "can_spawn_tasks": false,
    "can_assign_workers": false,
    "can_read_worker_results": false,
    "can_aggregate_results": false,
    "can_escalate_to_cloud": false,
    "can_modify_config": false,
    "can_execute_code": true,
    "can_delete_files": true,
    "requires_human_approval": []
  }
}
